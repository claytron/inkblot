<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>README.md</title>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='file' id='wrapper'>
<div class='header'>
<h1 class='name'>README.md
</h1>
<div class='paths'>
README.md
</div>
<div class='last-update'>
Last Update:
<span class='datetime'>2020-05-11 23:56:28 -0700</span>
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<h1 id="label-Inkblot"><a href="../classes/Inkblot.html"><code>Inkblot</code></a><span><a href="#label-Inkblot">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p><a href="../classes/Inkblot.html"><code>Inkblot</code></a> is a gem for interacting with Waveshare&#39;s line of E-paper displays on the Raspberry Pi using ruby. It includes components for outputting images, text, and menus to the EPD as well as reading input from HAT buttons on the side.</p>

<h2 id="label-Installation">Installation<span><a href="#label-Installation">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Add this line to your application&#39;s Gemfile:</p>

<pre class="ruby"><span class="ruby-identifier">gem</span> <span class="ruby-string">&#39;inkblot&#39;</span>, <span class="ruby-value">github:</span> <span class="ruby-string">&#39;jtp184/inkblot&#39;</span></pre>

<h2 id="label-Usage">Usage<span><a href="#label-Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Getting+Started">Getting Started<span><a href="#label-Getting+Started">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h3 id="label-The+Display+class">The Display class<span><a href="#label-The+Display+class">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The <code>Display</code> class handles outputting to the screen. It accepts an argument to its <code>.show</code> method to output to the screen, which can be any number of displayable objects.</p>

<pre class="ruby"><span class="ruby-identifier">items</span> = []&#x000A;&#x000A;<span class="ruby-comment"># Primarily used to display Components and Converters</span>&#x000A;<span class="ruby-identifier">items</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Components</span><span class="ruby-operator">::</span><span class="ruby-constant">SimpleText</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">text:</span> <span class="ruby-string">&#39;Hello&#39;</span>)&#x000A;<span class="ruby-identifier">items</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">ImageConverter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">path:</span> <span class="ruby-string">&#39;/home/pi/img.png&#39;</span>)&#x000A;<span class="ruby-comment"># Can also display (already correct bmp) files directly or by path</span>&#x000A;<span class="ruby-identifier">items</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;/home/pi/bump.bmp&#39;</span>) <span class="ruby-comment"># Or a TempFile</span>&#x000A;<span class="ruby-identifier">items</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;/home/pi/bump.bmp&#39;</span>&#x000A;&#x000A;<span class="ruby-comment"># call, show, and [] all work</span>&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Display</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">items</span>[<span class="ruby-value">0</span>])&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Display</span>.<span class="ruby-identifier">show</span>(<span class="ruby-identifier">items</span>[<span class="ruby-value">1</span>])&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Display</span>[<span class="ruby-identifier">items</span>[<span class="ruby-value">2</span>]]&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Display</span>.(<span class="ruby-identifier">items</span>[<span class="ruby-value">3</span>])&#x000A;&#x000A;<span class="ruby-comment"># Plaintext also works</span>&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Display</span>.(<span class="ruby-string">&quot;Show Me&quot;</span>)</pre>

<h3 id="label-Buttons">Buttons<span><a href="#label-Buttons">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The <code>Buttons</code> class deals with input from the HAT buttons. The buttons communicate over the Pi&#39;s GPIO pins, and can be used for a broad variety of inputs.</p>

<pre class="ruby"><span class="ruby-comment"># Setting up the buttons for use. This only needs to be run once at the start</span>&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Buttons</span>.<span class="ruby-identifier">init</span>&#x000A;<span class="ruby-comment"># You can check whether the buttons have been initialized with</span>&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Buttons</span>.<span class="ruby-identifier">ready?</span> <span class="ruby-comment"># =&gt; true</span>&#x000A;&#x000A;<span class="ruby-comment"># Basic input from buttons. With no argument, blocks until you press a button then returns an index</span>&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Buttons</span>.<span class="ruby-identifier">get_input</span> <span class="ruby-comment"># =&gt; 0</span>&#x000A;&#x000A;<span class="ruby-comment"># With an argument, it will timeout if no button is pressed.</span>&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Buttons</span>.<span class="ruby-identifier">get_input</span>(<span class="ruby-value">10</span>) <span class="ruby-comment"># =&gt; nil if no button is pressed for 10 seconds</span>&#x000A;&#x000A;<span class="ruby-comment"># It&#39;s also possible to get chords instead of single presses.</span>&#x000A;<span class="ruby-comment"># Specify the chord length and wait for simultaneous presses.</span>&#x000A;&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Buttons</span>.<span class="ruby-identifier">get_multi_input</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; [1, 2]</span>&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Buttons</span>.<span class="ruby-identifier">get_multi_input</span>(<span class="ruby-value">3</span>, <span class="ruby-value">10</span>) <span class="ruby-comment"># =&gt; nil || [0, 1, 3]</span>&#x000A;&#x000A;<span class="ruby-comment"># You can also record all button activity within a timeframe</span>&#x000A;&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Buttons</span>.<span class="ruby-identifier">get_raw_input</span>(<span class="ruby-value">3</span>) <span class="ruby-comment"># =&gt; [[], [0], [0, 1]...]</span></pre>

<p>Usually, you&#39;ll use the buttons with a display component. Components may have their own defined button actions, and the Buttons class can access them.</p>

<pre class="ruby"><span class="ruby-identifier">c</span> = <span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Components</span><span class="ruby-operator">::</span><span class="ruby-constant">ScrollMenu</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sc</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">div_height</span> = <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">div_width</span> = <span class="ruby-value">:full</span>&#x000A;  <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">items</span> = (<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>).<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;Option #{x}&quot;</span> }&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Display</span>.<span class="ruby-identifier">show</span>(<span class="ruby-identifier">c</span>)&#x000A;&#x000A;<span class="ruby-comment"># Calling .get_press gets the input, then calls the associated proc on the</span>&#x000A;<span class="ruby-comment"># currently displayed object, defined under .button_actions</span>&#x000A;<span class="ruby-constant">Buttons</span>.<span class="ruby-identifier">get_press</span>&#x000A;&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Display</span>.<span class="ruby-identifier">again</span></pre>

<h3 id="label-Components">Components<span><a href="#label-Components">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Components are composable views. They&#39;re written as ultra-basic ERB/HTML templates, with scaling applied to look good at the resolution of the EPD. These are then passed into <a href="https://wkhtmltopdf.org/">wkhtmltopdf</a> and another pass through ImageMagick to convert them into 1-deep <code>.bmp</code> files. No writing or comprehension of HTML is necessary though, as you merely pass in options to the constructor.</p>

<p>You can provide options to the constructor with standard or block syntax.</p>

<pre class="ruby"><span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Components</span><span class="ruby-operator">::</span><span class="ruby-constant">SimpleText</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">text:</span> <span class="ruby-string">&quot;Works this way&quot;</span>)&#x000A;&#x000A;<span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Components</span><span class="ruby-operator">::</span><span class="ruby-constant">SimpleText</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">st</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">st</span>.<span class="ruby-identifier">text</span> = <span class="ruby-string">&quot;Or this way&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>

<p>Passed in options can be retrieved through the options method, or defined accessors</p>

<pre class="ruby"><span class="ruby-identifier">c</span> = <span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Components</span><span class="ruby-operator">::</span><span class="ruby-constant">SimpleText</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">text:</span> <span class="ruby-string">&quot;Text&quot;</span>)&#x000A;&#x000A;<span class="ruby-identifier">c</span>.<span class="ruby-identifier">options</span>[<span class="ruby-value">:text</span>] <span class="ruby-comment"># =&gt; &quot;Text&quot;</span></pre>

<p>You can also compose components by passing them to <code>Component.create</code> method, which will combine the fragments together into a single page, top to bottom.</p>

<pre class="ruby"><span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Components</span><span class="ruby-operator">::</span><span class="ruby-constant">Component</span>.<span class="ruby-identifier">create</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cpt</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">cpt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Components</span><span class="ruby-operator">::</span><span class="ruby-constant">SimpleText</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">text:</span> <span class="ruby-string">&quot;Several&quot;</span>)&#x000A;        <span class="ruby-identifier">cpt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Components</span><span class="ruby-operator">::</span><span class="ruby-constant">SimpleText</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">text:</span> <span class="ruby-string">&quot;Different&quot;</span>)&#x000A;        <span class="ruby-identifier">cpt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Inkblot</span><span class="ruby-operator">::</span><span class="ruby-constant">Components</span><span class="ruby-operator">::</span><span class="ruby-constant">SimpleText</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">text:</span> <span class="ruby-string">&quot;Components&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>

<pre>&lt;!DOCTYPE html&gt;&#x000A;&lt;html&gt;&#x000A;        &lt;head&gt;&#x000A;        &lt;/head&gt;&#x000A;        &lt;body style=&quot;height: 176px; width: 264px;&quot;&gt;&#x000A;                &lt;div style=&quot;border: 0px solid black; box-sizing: border-box; height: 100%; width: 100%; display: flex; flex-flow: column; align-items: center; justify-content: center; text-align: center&quot;&gt;&#x000A;                &lt;h1 style=&quot;font-family: monospace; &quot;&gt;Several&lt;/h1&gt;&#x000A;                &lt;/div&gt;&#x000A;&#x000A;                &lt;div style=&quot;border: 0px solid black; box-sizing: border-box; height: 100%; width: 100%; display: flex; flex-flow: column; align-items: center; justify-content: center; text-align: center&quot;&gt;&#x000A;                &lt;h1 style=&quot;font-family: monospace; &quot;&gt;Different&lt;/h1&gt;&#x000A;                &lt;/div&gt;&#x000A;&#x000A;                &lt;div style=&quot;border: 0px solid black; box-sizing: border-box; height: 100%; width: 100%; display: flex; flex-flow: column; align-items: center; justify-content: center; text-align: center&quot;&gt;&#x000A;                &lt;h1 style=&quot;font-family: monospace; &quot;&gt;Components&lt;/h1&gt;&#x000A;                &lt;/div&gt;&#x000A;        &lt;/body&gt;&#x000A;&lt;/html&gt;</pre>

<h3 id="label-Built-in+Components">Built-in Components<span><a href="#label-Built-in+Components">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h3 id="label-Creating+new+Components">Creating new Components<span><a href="#label-Creating+new+Components">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h2 id="label-Contributing">Contributing<span><a href="#label-Contributing">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Bug reports, feature ideas, and pull requests are welcome on GitHub at <a href="https://github.com/jtp184/inkblot">github.com/jtp184/inkblot</a></p>
</div>
<div id='context'>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/rdoc/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
</div>
</body>
</html>
